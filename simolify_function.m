% syms w k z e x1 x2 
% % q=((w+1)/(w-1))^3+k*((w+1)/(w-1))^2+1.5*k*((w+1)/(w-1))-k-1 ;
%  gs=(((z-1)/10)*(((20)/(z-1)^2)-(3/(z-1))-(1/(z-(e)^(-20)))+(4/(z-(e)^(-10)))))/(1+((z-1)/10)*(((20)/(z-1)^2)-(3/(z-1))-(1/(z-(e)^(-20)))+(4/(z-(e)^(-10)))));
% % gz=(((z-1)/(100*z))*((200*z)/((z-1)^2)-((30*z)/(z-1))-((10*z)/(z-e^(-20)))+(40*z)/(z-e^(-10))));
% b=simplify(gs);
% pretty(gs)
% bz=simplify(gz);
% pretty(gz)
% ys_rs=(10*(z/10 - 1/10)*(3/(z - 1) - 20/(z - 1)^2 - (4*e^10)/(z*e^10 - 1) + e^20/(z*e^20 - 1)))/((z - 1)*(3/(z - 1) - 20/(z - 1)^2 - (4*e^10)/(z*e^10 - 1) + e^20/(z*e^20 - 1)) - 10);
% b1=simplify(ys_rs);
% % b2=(z - 1)*(3/(z - 1) - 20/(z - 1)^2 - (4*x1)/(z*x1 - 1) + x2/(z*x2 - 1));
% 
% b1=simplify(b1)
% b1=expand(b1)
% % pretty(b1);
% pretty(b1);
% [n d]=numden(b1)
% 
% z=((w+1)/(w-1));
% 
% up=17*e^30*((w+1)/(w-1))^2 + 3*e^30*((w+1)/(w-1)) + 4*e^20*((w+1)/(w-1))^2 - 25*e^20*((w+1)/(w-1)) + e^20 - e^10*((w+1)/(w-1))^2 - 15*e^10*((w+1)/(w-1)) - 4*e^10 - 3*((w+1)/(w-1)) + 23;
% down=10*e^30*((w+1)/(w-1))^3 + 7*e^30*((w+1)/(w-1))^2 + 3*e^30*((w+1)/(w-1)) - 6*e^20*((w+1)/(w-1))^2 - 15*e^20*((w+1)/(w-1)) + e^20 - 11*e^10*((w+1)/(w-1))^2 - 5*e^10*((w+1)/(w-1)) - 4*e^10 + 7*((w+1)/(w-1)) + 13;
% 
% down=simplify(down)
% down=expand(down)
% % pretty(b1);
% pretty(down);
% 
% [n1 d1]=numden(down)
% 
% d1 =w^3 - 3*w^2 + 3*w - 1;
% new1=solve(d1)
% 
% n1 =20*e^30*w^3 + 34*e^30*w^2 + 20*e^30*w + 6*e^30 - 20*e^20*w^3 + 6*e^20*w^2 + 24*e^20*w - 10*e^20 - 20*e^10*w^3 + 6*e^10*w^2 + 4*e^10*w + 10*e^10 + 20*w^3 - 46*w^2 + 32*w - 6;
%  
% 

%%   My Solution           %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  syms z e ;
%  e=2.71828;
% gz=((1-(z)^(-1))/100)/((200*z)/(z-1)^2-30*z/(z-1)+40*z/(z-e^(-10)) -10*z/(z-e^(-20)) );
% pretty(gz);
%  gz=simplify(gz);
% % pretty(gz);
%  
% fai=gz/(1+gz);
% pretty(fai);
% 
% % pzmap(fai);
% 
% [a1 b1]=numden(fai)
% %  roots(b1)
% % solx=solve(b1)
% % k=vpasolve(); 
% [p1, z1] = pzmap(a1, b1)
% figure
% 
% Az=e^30*z^5 + 16997*e^30*z^4 + 3003*e^30*z^3 - e^30*z^2 + 3999*e^20*z^4 - 24997*e^20*z^3 + 997*e^20*z^2 + e^20*z - 1001*e^10*z^4 - 14997*e^10*z^3 - 4003*e^10*z^2 + e^10*z - 2999*z^3 + 22997*z^2 + 3*z - 1;
% 
% 
% % root(Az)
% solx=solve(Az)
% double(solx)
%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% root(e^30*z1^5 + 16997*e^30*z1^4 + 3999*e^20*z1^4 - 1001*e^10*z1^4 - 24997*e^20*z1^3 - 14997*e^10*z1^3 + 3003*e^30*z1^3 - 2999*z1^3 - 4003*e^10*z1^2 + 997*e^20*z1^2 - e^30*z1^2 + 22997*z1^2 + 3*z1 + e^20*z1 + e^10*z1 - 1, z1, 1)

% double(solx)


%  a1=
%  
% (z - 1)^3*(z*e^10 - 1)*(z*e^20 - 1)
%  
%  
% b1 =
%  
% e^30*z^5 + 16997*e^30*z^4 + 3003*e^30*z^3 - e^30*z^2 + 3999*e^20*z^4 - 24997*e^20*z^3 + 997*e^20*z^2 + e^20*z - 1001*e^10*z^4 - 14997*e^10*z^3 - 4003*e^10*z^2 + e^10*z - 2999*z^3 + 22997*z^2 + 3*z - 1
%  
%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
h=tf(2,[0.005 0.15 1 0])%G2(s)
s=tf('s');

s1=(1-exp(-1*s))/s;%G1(s)

Gs=series(s1,h)

G=c2d(Gs,1,'zoh')%z变换

fai=G/(G+1)%闭环传递函数

pzplot(fai);%作出零极点图


 syms z e ;%符号表达式
 e=2.71828;
T=1;
 gz=((1-(z)^(-1))/100)/((200*z)/(z-1)^2-30*z/(z-1)+40*z/(z-e^(-10)) -10*z/(z-e^(-20)));%开环脉冲传递函数

 pretty(gz);%化为分式

 Kp=1/(1+limit(gz,z,1));%单位阶跃信号
 Kp=double(Kp);
disp(['单位阶跃信号稳态误差为 ' num2str(Kp)]);
 
tempGz=1/((z-1)*gz);
Kv=T*limit(tempGz,z,1);%单位斜坡信号
 Kv=double(Kv);
disp(['单位斜坡信号稳态误差为 ' num2str(Kv)]);
 















